Doctormms v1.0 (https://www.sourcecodester.com/php/14182/doctor-appointment-system.html) was discovered to contain a SQL injection vulnerability (CVE-2023-39852) via the $userid parameter at myAppoinment.php.

24.	$sql = " SELECT * FROM booking WHERE userid='".$_SESSION["userid"]."'";
25.	$result = mysqli_query($conn,$sql);
26.	$count = mysqli_num_rows($result);

Trigger: 
   The "userid" originates from "$_SESSION["userid"] = $_POST["userid"]" at doctors\doctorlogin.php. It is not a session variable controlled by the server and does not represent an auto-increment type number in the database. It's vulnerable.


At line 24 of the code, the $_SESSION["userid"] value is directly utilized within an SQL statement and from "$_SESSION["userid"] = $_POST["userid"]" at doctors\doctorlogin.php. Subsequently, a query is executed at line 25, leading to a potential database leak.
If an attacker hijacked the session and stores a malicious value "12 or 1=1 #" in the $_POST["userid"], the executed SQL statement becomes SELECT * FROM booking WHERE userid=12 or 1=1 #'. This action can result in a significant data exposure, potentially affecting the entire booking dataset.
Similarly, if the attacker deposits '1'; system shutdown;#' into the session, the outcome remains concerning, triggering a database shutdown.

