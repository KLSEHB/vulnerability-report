Claimï¼š** REJECT ** DO NOT USE THIS CANDIDATE NUMBER. ConsultIDs: none. Reason: This candidate was withdrawn by its CNA. Further investigation showed that it was not a security issue. Notes: none.
For a test!


Pikachu v1.0 (https://github.com/zhuifengshaonianhanlu/pikachu) was discovered to contain a SQL injection vulnerability(CVE-2023-39849) via the $username parameter at \inc\function.php.

132.	function check_sqli_login($link){
133.	    if(isset($_COOKIE['ant']['uname']) && isset($_COOKIE['ant']['pw'])){
134.	        //If the obtained cookies are not properly sanitized, it could lead to an SQL injection vulnerability and potentially bypass authentication.
135.	        //$username=escape($link, $_COOKIE['ant']['username']);
136.	        //$password=escape($link, $_COOKIE['ant']['password']);
137.	        $username=$_COOKIE['ant']['uname'];
138.	        $password=$_COOKIE['ant']['pw'];
139.	
140.	
141.	        $query="select * from users where username='$username' and sha1(password)='$password'";
142.	
143.	        $result=execute($link,$query);
144.	        if(mysqli_num_rows($result)==1){
145.	            $data=mysqli_fetch_assoc($result);
146.	            return $data['id'];
147.	        }else{
148.	            return false;
149.	        }
150.	    }else{
151.	        return false;
152.	    }
153.	}


At line 137 of the code, the variable $username is fetched from the cookie, but without any validation or filtering, it is directly passed into the $query statement. 
This practice poses a potential risk of data loss or unauthorized privilege escalation
. For example, if an attacker stores $username=admin' or 1=1 # and $password=1 in a cookie, the resulting SQL statement would be select * from users where username='admin' or 1=1 #' and sha1(password)='1', potentially leading to data leakage. 
Similarly, if an attacker stores $username=admin' and 1=1 # and $password=1 in a cookie, the executed SQL statement would be select * from users where username='admin' and 1=1 #' and sha1(password)='1', enabling the attacker to gain full privileges of the admin user.
